---
import '../styles/global.css';

const apiUrl = import.meta.env.PUBLIC_API_URL || 'http://localhost:3000';
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <title>Logging out - GSD</title>
  </head>
  <body class="min-h-screen flex items-center justify-center">
    <div class="text-center">
      <h1 class="text-2xl font-bold mb-4">Logging out...</h1>
      <div class="mt-4">
        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-foreground">
        </div>
      </div>
    </div>

    <script define:vars={{ apiUrl }}>
      async function logout() {
        try {
          console.log('Calling logout API...');
          const response = await fetch(`${apiUrl}/auth/signout`, {
            method: 'POST',
            credentials: 'include'
          });
          console.log('Logout response:', response.status);
        } catch (error) {
          console.error('Logout error:', error);
        } finally {
          // Always redirect to home, even if logout fails
          console.log('Redirecting to home page');
          window.location.href = '/';
        }
      }

      logout();
    </script>
  </body>
</html>
